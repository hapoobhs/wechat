<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>微信墙</title>
  <style>
    li > img{
      width: 32px;
    }
  </style>
</head>


<body>
  <ul id="messages">
    
  </ul>
  <p>
    can you see me?
  </p>


<script type="text/javascript">
  var msglist = document.getElementById('messages');
  var ws = new WebSocket('ws:123.206.84.71:10000/');
  ws.onmessage = function(evt)
  {
    console.log(evt.data)
    var msg = JSON.parse(evt.data);
    
    if(msg.xml.MsgType[0]==='text'){
     var content = msg.xml.Content[0];
      oLi.innerHTML = userName + '<img src="'+headimg+'">' + '说:' + content;
    }
    else if(msg.xml.MsgType[0]==='image'){
      var content = msg.xml.PicUrl[0];
       oLi.innerHTML = userName + '<img src="'+headimg+'">' + '说:' + '<img src='+content+'>';
    }

    msg.user = msg.user || {};
    var userName = msg.user.nickname;
    var headimg = msg.user.headimgurl;
    var oLi = document.createElement('li');
    // oLi.innerHTML = userName + '<img src="'+headimg+'">' + '说:' + content;
    msglist.appendChild(oLi);
  };
</script>
</body>
</html>